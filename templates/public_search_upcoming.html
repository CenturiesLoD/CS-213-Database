{% extends "base.html" %}
{% block content %}
<h2>Public Flight Search</h2>

<form method="GET" action="{{ url_for('public.public_search_upcoming') }}">
  <label>Airport code (arrival):</label>
  <input type="text" name="qArrive" value="{{ qArrive|default('') }}" placeholder="e.g. JFK">

  <label>Airport code (departure):</label>
  <input type="text" name="qDepart" value="{{ qDepart|default('') }}" placeholder="e.g. LAX">

  <label>City (arrival):</label>
  <input type="text" name="qCityArr" value="{{ qCityArr|default('') }}" placeholder="e.g. New York">

  <label>City (departure):</label>
  <input type="text" name="qCityDep" value="{{ qCityDep|default('') }}" placeholder="e.g. New York">

  <label>Date:</label>
  <input type="date" name="qDate" value="{{ qDate|default('') }}">
  <button type="submit">Search</button>
</form>

{% if flights %}
  <h3>Search Results</h3>

  <p>
    Filters:
    {% if qArrive %} Arrival airport = "{{ qArrive }}"{% endif %}
    {% if qDepart %}{% if qArrive %};{% endif %} Departure Airport = "{{ qDepart }}"{% endif %}
    {% if qCityArr %}{% if qArrive%};{% endif %} Arrival City = "{{ qCityArr }}"{% endif %}
    {% if qCityDep %}{% if qDepart %};{% endif %} Departure City = "{{ qCityDep }}"{% endif %}
    {% if qDate %}{% if qArrive or qDepart or qCity %};{% endif %} Date = "{{ qDate }}"{% endif %}
  <table>
    <thead>
      <tr>
        <th>Airline</th>
        <th>Flight #</th>
        <th>Departure</th>
        <th>Departure Time</th>
        <th>Arrival</th>
        <th>Arrival Time</th>
        <th>Status</th>
      </tr>
    </thead>
    <tbody>
      {% for f in flights %}
      <tr>
        <td>{{ f.airline_name }}</td>
        <td>{{ f.flight_num }}</td>
        <td>{{ f.departure_airport }}</td>
        <td>{{ f.departure_time }}</td>
        <td>{{ f.arrival_airport }}</td>
        <td>{{ f.arrival_time }}</td>
        <td>{{ f.status }}</td>
      </tr>
      {% endfor %}
    </tbody>
  </table>
{% elif qArrive or qDepart or qCityArr or qCityDep or qDate %}
  <p>No upcoming flights found for your search.</p>
{% endif %}

{% endblock %}
